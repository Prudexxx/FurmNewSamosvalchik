<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Ñ–æ—Ä–º–∞</title>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<style>
  * {
    color: #000000 !important;
  }

  body {
    font-family: Arial, sans-serif;
    margin: 20px;
    background: #9e86e2;
  }

  form {
    background: #f19c3b;
    padding: 20px;
    max-width: 800px;
    margin: auto;
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
  }

  .form-group {
    flex: 1 1 100%;
    display: flex;
    flex-direction: column;
    min-width: 200px;
  }

  @media (min-width: 600px) {
    .form-row {
      display: flex;
      gap: 15px;
    }
    .form-group-half {
      flex: 1 1 48%;
    }
  }

  label {
    margin-bottom: 5px;
    font-weight: bold;
    color: #000000;
  }

  input[type="text"],
  input[type="date"],
  input[type="number"],
  textarea,
  select {
    padding: 8px;
    border: 1px solid #666;
    border-radius: 4px;
    font-size: 14px;
    width: 100%;
    box-sizing: border-box;
    color: #000000 !important;
    background-color: white;
  }

  input::placeholder,
  textarea::placeholder {
    color: #666 !important;
    opacity: 1;
  }

  textarea {
    resize: vertical;
  }

  button {
    padding: 12px 20px;
    background-color: #007bff;
    border: none;
    border-radius: 4px;
    color: white !important;
    font-size: 16px;
    cursor: pointer;
    margin-top: 10px;
    align-self: flex-start;
  }

  button:hover {
    background-color: #0069d9;
  }

  h2 {
    text-align: center;
    color: #000000;
  }

  .date-container {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .date-options {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
  }

  .date-option {
    display: flex;
    align-items: center;
    gap: 5px;
    cursor: pointer;
    color: #000000;
  }

  .date-option input {
    margin: 0;
  }

  .date-option span {
    color: #000000;
  }

  .loading {
    display: none;
    text-align: center;
    padding: 10px;
    color: #000000 !important;
    background-color: #f8f9fa;
    border-radius: 4px;
    margin: 10px auto;
    max-width: 800px;
  }

  .success-message {
    display: none;
    text-align: center;
    padding: 10px;
    background-color: #d4edda;
    color: #000000 !important;
    border-radius: 4px;
    margin: 10px auto;
    max-width: 800px;
    border: 1px solid #c3e6cb;
  }

  .error-message {
    display: none;
    text-align: center;
    padding: 10px;
    background-color: #f8d7da;
    color: #000000 !important;
    border-radius: 4px;
    margin: 10px auto;
    max-width: 800px;
    border: 1px solid #f5c6cb;
  }
</style>
</head>
<body>

  <h2>–§–æ—Ä–º–∞ –ó–∞–∫–∞–∑–∞</h2>
  
  <div class="loading" id="loading">–û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
  <div class="success-message" id="successMessage">‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã!</div>
  <div class="error-message" id="errorMessage"></div>

  <form id="transportForm">
    <div class="form-row">
      <div class="form-group form-group-half">
        <label for="material">–ú–∞—Ç–µ—Ä–∏–∞–ª</label>
        <input type="text" id="material" name="material" placeholder="–í–≤–µ–¥–∏—Ç–µ –º–∞—Ç–µ—Ä–∏–∞–ª" required>
      </div>

      <div class="form-group form-group-half">
        <label for="delivery_date">–î–∞—Ç–∞ –¥–æ—Å—Ç–∞–≤–∫–∏</label>
        <div class="date-container">
          <div class="date-options">
            <label class="date-option">
              <input type="radio" name="delivery_type" value="date" checked>
              <span>–í—ã–±—Ä–∞—Ç—å –¥–∞—Ç—É</span>
            </label>
            <label class="date-option">
              <input type="radio" name="delivery_type" value="call">
              <span>–ü–æ –∑–≤–æ–Ω–∫—É</span>
            </label>
            <label class="date-option">
              <input type="radio" name="delivery_type" value="ready">
              <span>–ü–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏</span>
            </label>
          </div>
          <input type="date" id="delivery_date" name="delivery_date" required>
        </div>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="volume">–û–±—ä—ë–º</label>
        <div class="volume-container">
          <select id="volume" name="volume" required>
            <option value="–º3">–º¬≥</option>
            <option value="—Ç">—Ç</option>
          </select> 
        </div>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group form-group-half">
        <label for="quantity">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</label>
        <input type="number" id="quantity" name="quantity" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ" required>
      </div>

      <div class="form-group form-group-half">
        <label for="price">–¶–µ–Ω–∞</label>
        <input type="number" id="price" name="price" placeholder="–¶–µ–Ω–∞" required>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="district">–†–∞–π–æ–Ω</label>
        <input type="text" id="district" name="district" placeholder="–†–∞–π–æ–Ω" required>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="address_name">–ê–¥—Ä–µ—Å, –∏–º—è</label>
        <input type="text" id="address_name" name="address_name" placeholder="–ê–¥—Ä–µ—Å, –∏–º—è" required>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="phone">–¢–µ–ª–µ—Ñ–æ–Ω</label>
        <input type="text" id="phone" name="phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω" required>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="manager_name">–ò–º—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞</label>
        <input type="text" id="manager_name" name="manager_name" placeholder="–ò–º—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞" required>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="source">–û—Ç–∫—É–¥–∞ —É–∑–Ω–∞–ª–∏ –æ –Ω–∞—Å?</label>
        <input type="text" id="source" name="source" placeholder="–û—Ç–∫—É–¥–∞ —É–∑–Ω–∞–ª–∏ –æ –Ω–∞—Å" required>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="comment">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label>
        <textarea id="comment" name="comment" rows="3" placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π"></textarea>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="carrier">–ü–µ—Ä–µ–≤–æ–∑—á–∏–∫</label>
        <input type="text" id="carrier" name="carrier" placeholder="–ü–µ—Ä–µ–≤–æ–∑—á–∏–∫">
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="commission">–ö–æ–º–∏—Å—Å–∏—è</label>
        <input type="number" id="commission" name="commission" placeholder="–ö–æ–º–∏—Å—Å–∏—è">
      </div>
    </div>

    <button type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
  </form>

<script>
  // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram
  const TELEGRAM_BOT_TOKEN = '7749887573:AAGAsaFD44-OcKNWOybvz4ceIG1qgps5pE8';
  const TELEGRAM_CHAT_ID = '421332431';
  
  // URL Google Apps Script
  const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwFQ0RiofQcBpC56uztdJkV1PmDCjhzTKQ8F_Hkh8ZsxTpoaEQF2JThJk02g3Mqu7CuSA/exec';

  // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª–µ–º –¥–∞—Ç—ã
  window.updateDateField = function() {
    const selectedOption = document.querySelector('input[name="delivery_type"]:checked').value;
    const dateInput = document.getElementById('delivery_date');
    
    if (selectedOption === 'date') {
      dateInput.style.display = 'block';
      dateInput.required = true;
    } else {
      dateInput.style.display = 'none';
      dateInput.required = false;
    }
  };
  
  document.addEventListener('DOMContentLoaded', function() {
    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–π –¥–∞—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    const today = new Date();
    const yyyy = today.getFullYear();
    const mm = String(today.getMonth() + 1).padStart(2, '0');
    const dd = String(today.getDate()).padStart(2, '0');
    const todayFormatted = `${yyyy}-${mm}-${dd}`;
    
    document.getElementById('delivery_date').value = todayFormatted;
    
    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç—å—é –ø–æ–ª—è –¥–∞—Ç—ã
    const dateOptions = document.querySelectorAll('input[name="delivery_type"]');
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    updateDateField();
    
    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞ —Ä–∞–¥–∏–æ–∫–Ω–æ–ø–∫–∏
    dateOptions.forEach(option => {
      option.addEventListener('change', updateDateField);
    });
  });

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Axios
  async function sendToTelegram(dataObject) {
    try {
      console.log('–ù–∞—á–∏–Ω–∞–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É –≤ Telegram...');
      
      // –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è Telegram
      const selectedOption = document.querySelector('input[name="delivery_type"]:checked').value;
      let deliveryDateText = '';
      
      if (selectedOption === 'date') {
        const date = new Date(dataObject.delivery_date);
        const day = date.getDate().toString().padStart(2, '0');
        const month = (date.getMonth() + 1).toString().padStart(2, '0');
        const year = date.getFullYear();
        deliveryDateText = `${day}.${month}.${year}`;
      } else if (selectedOption === 'call') {
        deliveryDateText = '–ü–æ –∑–≤–æ–Ω–∫—É';
      } else if (selectedOption === 'ready') {
        deliveryDateText = '–ü–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏';
      }
      
      const message = `üì¶ –ù–û–í–ê–Ø –ó–ê–Ø–í–ö–ê üì¶

üìå –ú–∞—Ç–µ—Ä–∏–∞–ª: ${dataObject.material || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}
üìÖ –î–∞—Ç–∞ –¥–æ—Å—Ç–∞–≤–∫–∏: ${deliveryDateText}
üìä –û–±—ä—ë–º: ${dataObject.volume || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}
üî¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: ${dataObject.quantity || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}
üí∞ –¶–µ–Ω–∞: ${dataObject.price || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}
üìç –†–∞–π–æ–Ω: ${dataObject.district || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}
üè† –ê–¥—Ä–µ—Å –∏ –∏–º—è: ${dataObject.address_name || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}
üì± –¢–µ–ª–µ—Ñ–æ–Ω: ${dataObject.phone || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}
üë§ –ú–µ–Ω–µ–¥–∂–µ—Ä: ${dataObject.manager_name || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}
üîç –ò—Å—Ç–æ—á–Ω–∏–∫: ${dataObject.source || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}
üìù –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: ${dataObject.comment || '–ù–µ—Ç'}
üöö –ü–µ—Ä–µ–≤–æ–∑—á–∏–∫: ${dataObject.carrier || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}
üíµ –ö–æ–º–∏—Å—Å–∏—è: ${dataObject.commission || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}
‚è∞ –í—Ä–µ–º—è –∑–∞—è–≤–∫–∏: ${new Date().toLocaleString('ru-RU')}`;

      console.log('–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è Telegram:', message);
      
      // –ò—Å–ø–æ–ª—å–∑—É–µ–º Axios –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
      const telegramUrl = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`;
      
      console.log('URL Telegram:', telegramUrl);
      
      const response = await axios.post(telegramUrl, {
        chat_id: TELEGRAM_CHAT_ID,
        text: message,
        parse_mode: 'HTML'
      });
      
      console.log('‚úÖ Telegram –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω:', response.data);
      
      if (response.data.ok) {
        return true;
      } else {
        throw new Error(response.data.description || 'Telegram error');
      }
      
    } catch (error) {
      console.error('‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram:', error);
      
      // –ü—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ —á–µ—Ä–µ–∑ Image –¥–ª—è –æ–±—Ö–æ–¥–∞ CORS
      try {
        console.log('–ü—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ –æ—Ç–ø—Ä–∞–≤–∫–∏...');
        
        const shortMessage = `–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞! –¢–µ–ª: ${dataObject.phone || '–ù–µ—Ç'}, –ê–¥—Ä–µ—Å: ${dataObject.address_name || '–ù–µ—Ç'}`;
        const img = new Image();
        img.src = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage?chat_id=${TELEGRAM_CHAT_ID}&text=${encodeURIComponent(shortMessage)}`;
        
        console.log('–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ –∑–∞–ø—É—â–µ–Ω');
        return true;
      } catch (fallbackError) {
        console.error('–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ —Ç–æ–∂–µ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª:', fallbackError);
        // –í—Å–µ —Ä–∞–≤–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É –≤ Google Sheets
        return false;
      }
    }
  }

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ Google Sheets
  async function sendToGoogleSheets(dataObject) {
    try {
      // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è
      const now = new Date();
      const timestamp = now.toLocaleString('ru-RU');
      
      // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–∫—Å—Ç –¥–ª—è –¥–∞—Ç—ã –¥–æ—Å—Ç–∞–≤–∫–∏
      const selectedOption = document.querySelector('input[name="delivery_type"]:checked').value;
      let deliveryDateText = '';
      
      if (selectedOption === 'date') {
        deliveryDateText = dataObject.delivery_date;
      } else if (selectedOption === 'call') {
        deliveryDateText = '–ü–æ –∑–≤–æ–Ω–∫—É';
      } else if (selectedOption === 'ready') {
        deliveryDateText = '–ü–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏';
      }
      
      // –§–æ—Ä–º–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
      const payload = {
        timestamp: timestamp,
        material: dataObject.material || '',
        delivery_date: deliveryDateText,
        volume: dataObject.volume || '',
        quantity: dataObject.quantity || '',
        price: dataObject.price || '',
        district: dataObject.district || '',
        address_name: dataObject.address_name || '',
        phone: dataObject.phone || '',
        comment: dataObject.comment || '',
        carrier: dataObject.carrier || '',
        commission: dataObject.commission || '',
         manager_name: dataObject.manager_name || '',
        source: dataObject.source || '',
      };
      
      console.log('–û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Google Sheets:', payload);
      
      // –°–æ–∑–¥–∞–µ–º URL —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
      const params = new URLSearchParams(payload);
      const urlWithParams = `${GOOGLE_SCRIPT_URL}?${params.toString()}`;
      
      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å
      await fetch(urlWithParams, {
        method: 'GET',
        mode: 'no-cors'
      });
      
      console.log('‚úÖ –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ Google Sheets');
      return true;
      
    } catch (error) {
      console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –≤ Google Sheets:', error);
      throw error;
    }
  }

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
  document.getElementById('transportForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
    document.getElementById('loading').style.display = 'block';
    document.getElementById('successMessage').style.display = 'none';
    document.getElementById('errorMessage').style.display = 'none';
    
    // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–æ—Ä–º—ã
    const formData = new FormData(e.target);
    const dataObject = {};
    formData.forEach((value, key) => {
      dataObject[key] = value;
    });
    
    console.log('–°–æ–±—Ä–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:', dataObject);
    
    try {
      // –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Telegram –∏ Google Sheets
      const telegramPromise = sendToTelegram(dataObject);
      const sheetsPromise = sendToGoogleSheets(dataObject);
      
      // –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–±–æ–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
      const [telegramResult, sheetsResult] = await Promise.allSettled([
        telegramPromise,
        sheetsPromise
      ]);
      
      console.log('–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç–ø—Ä–∞–≤–∫–∏:', {
        telegram: telegramResult.status,
        sheets: sheetsResult.status
      });
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
      let hasError = false;
      let errorMessage = '';
      
      if (telegramResult.status === 'rejected') {
        console.warn('‚ö†Ô∏è Telegram –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏–ª—Å—è, –Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º...');
      }
      
      if (sheetsResult.status === 'rejected') {
        hasError = true;
        errorMessage = '–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Google Sheets';
      }
      
      if (hasError) {
        throw new Error(errorMessage);
      }
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
      document.getElementById('loading').style.display = 'none';
      document.getElementById('successMessage').style.display = 'block';
      
      // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
      e.target.reset();
      
      // –°–±—Ä–æ—Å –¥–∞—Ç—ã –Ω–∞ —Å–µ–≥–æ–¥–Ω—è—à–Ω—é—é
      const today = new Date();
      const yyyy = today.getFullYear();
      const mm = String(today.getMonth() + 1).padStart(2, '0');
      const dd = String(today.getDate()).padStart(2, '0');
      document.getElementById('delivery_date').value = `${yyyy}-${mm}-${dd}`;
      
      // –°–±—Ä–æ—Å —Ä–∞–¥–∏–æ–∫–Ω–æ–ø–æ–∫
      document.querySelector('input[name="delivery_type"][value="date"]').checked = true;
      
      // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–ª–µ –¥–∞—Ç—ã
      if (typeof window.updateDateField === 'function') {
        window.updateDateField();
      }
      
      // –°–∫—Ä—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
      setTimeout(() => {
        document.getElementById('successMessage').style.display = 'none';
      }, 5000);
      
    } catch (error) {
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
      document.getElementById('loading').style.display = 'none';
      document.getElementById('errorMessage').style.display = 'block';
      document.getElementById('errorMessage').textContent = error.message || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –¥–∞–Ω–Ω—ã—Ö. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.';
      console.error('‚ùå –û–±—â–∞—è –æ—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏:', error);
      
      // –°–∫—Ä—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
      setTimeout(() => {
        document.getElementById('errorMessage').style.display = 'none';
      }, 5000);
    }
  });
</script>
</body>
</html>